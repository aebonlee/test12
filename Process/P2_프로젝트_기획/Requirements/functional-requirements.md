# ValueLink 기능 요구사항

**작성일**: 2026-02-05
**버전**: 1.0
**프로젝트**: ValueLink - AI 기업가치평가 플랫폼

---

## 개요

본 문서는 ValueLink 플랫폼의 **기능 요구사항 (Functional Requirements)**을 정의합니다.

### 요구사항 추출 방법

```
✅ 역공학 방식 (Reverse Engineering)
✅ 기존 126개 Python 파일 분석
✅ 기존 72개 HTML 페이지 분석
✅ Supabase 데이터베이스 스키마 분석
✅ 5개 평가 엔진 로직 분석
```

---

## 1. 사용자 역할 및 권한

### 1.1 역할 정의

| 역할 | 코드 | 설명 | 권한 |
|------|------|------|------|
| **고객** | `customer` | 평가 요청 기업 | 본인 프로젝트만 |
| **회계사** | `accountant` | 평가 수행 전문가 | 할당된 프로젝트 |
| **관리자** | `admin` | 시스템 관리자 | 모든 프로젝트 |
| **투자자** | `investor` | 투자 기회 탐색 | 랭킹 조회 (계획) |

### 1.2 권한 매트릭스

| 기능 | 고객 | 회계사 | 관리자 | 투자자 |
|------|------|--------|--------|--------|
| **프로젝트 생성** | ✅ | ❌ | ✅ | ❌ |
| **프로젝트 조회** | 본인 | 할당 | 전체 | ❌ |
| **프로젝트 수정** | 본인 | 할당 | 전체 | ❌ |
| **프로젝트 삭제** | ❌ | ❌ | ✅ | ❌ |
| **승인 포인트 처리** | ❌ | ✅ | ✅ | ❌ |
| **사용자 관리** | ❌ | ❌ | ✅ | ❌ |
| **결제 관리** | ✅ | ❌ | ✅ | ❌ |
| **랭킹 조회** | ✅ | ❌ | ✅ | ✅ |

---

## 2. 인증 & 인가 (Authentication & Authorization)

### FR-001: 사용자 회원가입

**우선순위**: P0 (필수)
**Stage**: S2

**요구사항**:
- 이메일 + 비밀번호 회원가입
- 이메일 인증 (Supabase Auth)
- 비밀번호 요구사항:
  - 최소 8자
  - 영문, 숫자, 특수문자 포함
- 회원가입 완료 시 Welcome 이메일 발송

**입력**:
- 이메일 (필수)
- 비밀번호 (필수)
- 비밀번호 확인 (필수)
- 이름 (필수)
- 역할 선택 (필수)

**출력**:
- 사용자 계정 생성
- `auth.users` 테이블에 저장
- 이메일 인증 링크 발송

**검증**:
- 이메일 중복 체크
- 비밀번호 강도 체크
- 이메일 형식 검증

### FR-002: Google OAuth 로그인

**우선순위**: P0 (필수)
**Stage**: S2

**요구사항**:
- Google OAuth 2.0 연동
- 로그인 성공 시 대시보드 이동
- 신규 사용자는 자동 회원가입

**흐름**:
1. 사용자가 "Google로 로그인" 버튼 클릭
2. Google 로그인 페이지로 리디렉션
3. Google 인증 완료
4. Callback URL로 돌아옴 (토큰 포함)
5. Supabase에서 사용자 생성 또는 조회
6. JWT 토큰 발급
7. 대시보드로 이동

### FR-003: 비밀번호 재설정

**우선순위**: P1 (중요)
**Stage**: S2

**요구사항**:
- 이메일로 비밀번호 재설정 링크 발송
- 링크 유효 기간: 1시간
- 재설정 완료 시 모든 세션 로그아웃

### FR-004: 세션 관리

**우선순위**: P0 (필수)
**Stage**: S2

**요구사항**:
- JWT 토큰 기반 인증
- 토큰 유효 기간: 7일
- Refresh Token 자동 갱신
- 로그아웃 시 토큰 무효화

---

## 3. 프로젝트 관리

### FR-010: 프로젝트 생성

**우선순위**: P0 (필수)
**Stage**: S2

**요구사항**:
- 고객이 평가 요청 프로젝트 생성
- 필수 정보 입력
- 평가 방법 선택 (DCF, Relative, Tax, IPO, Asset)

**입력**:
- 회사명 (필수)
- 업종 (필수)
- 매출액 (필수)
- 직원 수 (선택)
- 설립일 (선택)
- 평가 목적 (필수): 투자유치, M&A, 가업승계, IPO, 기타
- 평가 방법 (필수): DCF, Relative, Tax, IPO, Asset

**출력**:
- `projects` 테이블에 저장
- 프로젝트 ID 생성
- 초기 상태: `draft`

**검증**:
- 회사명 중복 체크 (같은 사용자)
- 매출액 > 0
- 평가 방법 유효성 체크

### FR-011: 프로젝트 조회

**우선순위**: P0 (필수)
**Stage**: S2

**요구사항**:
- 역할별 권한에 따라 프로젝트 목록 조회
- 필터링: 상태, 평가 방법, 날짜
- 정렬: 생성일, 업데이트일
- 페이지네이션: 10개/페이지

**필터**:
- 상태: draft, submitted, in_progress, completed, cancelled
- 평가 방법: DCF, Relative, Tax, IPO, Asset
- 날짜 범위: 시작일 ~ 종료일

### FR-012: 프로젝트 수정

**우선순위**: P1 (중요)
**Stage**: S2

**요구사항**:
- 상태가 `draft` 또는 `submitted`일 때만 수정 가능
- `in_progress` 이상이면 수정 불가

### FR-013: 프로젝트 상태 전이

**우선순위**: P0 (필수)
**Stage**: S3

**상태 흐름**:
```
draft (초안)
  ↓
submitted (제출됨)
  ↓
quote_sent (견적 발송)
  ↓
negotiation (협상 중)
  ↓
contract_signed (계약 완료)
  ↓
payment_completed (결제 완료)
  ↓
in_progress (진행 중)
  ↓
completed (완료)
  ↓
delivered (납품 완료)

(취소 가능)
  ↓
cancelled (취소됨)
```

---

## 4. 14단계 워크플로우

### FR-020: Step 01 - 평가 요청

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 프로젝트 기본 정보 입력
- 평가 방법 선택
- 평가 목적 선택

### FR-021: Step 02 - 견적 제공

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 관리자가 견적 생성
- 평가 방법별 가격 자동 계산
- 견적서 이메일 발송

**가격표**:
| 평가 방법 | 가격 | 납기 |
|----------|------|------|
| DCF | 800만원 | 7-10일 |
| Relative | 500만원 | 5-7일 |
| Tax | 1,000만원 | 10-14일 |
| IPO | 2,000만원 | 14-21일 |
| Asset | 600만원 | 7-10일 |

### FR-022: Step 03 - 견적 검토

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 고객이 견적 확인
- 승인 / 거부 선택
- 거부 시 사유 입력

### FR-023: Step 04 - 협상

**우선순위**: P1 (중요)
**Stage**: S3

**요구사항**:
- 고객-관리자 간 협상
- 가격/납기 조정
- 협상 이력 저장 (`negotiations` 테이블)

### FR-024: Step 05 - 계약

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 계약서 자동 생성
- 전자서명 (향후)
- 계약서 PDF 다운로드

### FR-025: Step 06 - 결제

**우선순위**: P0 (필수)
**Stage**: S4

**요구사항**:
- Stripe 연동
- 결제 수단: 신용카드, 계좌이체
- 결제 완료 시 이메일 발송
- 세금계산서 자동 발행 (향후)

### FR-026: Step 07 - 서류 업로드

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 고객이 필요 서류 업로드
- 파일 형식: PDF, Excel, Word, Image
- 최대 파일 크기: 10MB/파일
- 총 용량 제한: 100MB/프로젝트
- Supabase Storage에 저장

**필요 서류** (평가 방법별):
- **DCF**: 재무제표 3년, 사업계획서
- **Relative**: 유사 기업 정보, 재무 정보
- **Tax**: 재무제표, 세무 신고서
- **IPO**: 감사보고서, 사업보고서
- **Asset**: 자산 목록, 부채 목록

### FR-027: Step 08 - 데이터 추출

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- AI (Claude, Gemini)가 업로드된 서류에서 데이터 추출
- OCR (이미지 → 텍스트)
- 추출된 데이터를 구조화된 JSON으로 저장

**추출 항목**:
- 재무 데이터: 매출, 영업이익, 당기순이익, 자산, 부채, 자본
- 비율 데이터: 매출성장률, 영업이익률, 순이익률
- 기타: 업종, 직원 수, 설립일

### FR-028: Step 09 - 초안 생성

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- AI (Claude)가 평가 보고서 초안 자동 생성
- 20-30 페이지 분량
- 평가 방법별 템플릿 사용
- Markdown 형식으로 저장 (`drafts` 테이블)

**초안 구성**:
1. 회사 개요 (2페이지)
2. 업종 분석 (3페이지)
3. 재무 분석 (5페이지)
4. 평가 방법론 (3페이지)
5. 평가 결과 (5페이지)
6. 시나리오 분석 (3페이지)
7. 결론 (2페이지)
8. 부록 (7페이지)

### FR-029: Step 10 - 승인 포인트

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- AI가 22개 승인 포인트 생성
- 각 포인트마다 3개 시나리오 제시:
  - 낙관적 (Optimistic)
  - 중립적 (Neutral) ← AI 추천
  - 보수적 (Conservative)
- 회계사가 승인/수정/거부
- 승인 이력 저장 (`approval_points` 테이블)

**승인 포인트 예시** (22개):
1. 매출 성장률 가정
2. 영업이익률 가정
3. CAPEX 가정
4. 운전자본 변동 가정
5. 할인율 (WACC)
6. 영구 성장률
7. 시장 규모 예측
8. 시장 점유율 예측
9. 유사 기업 선정
10. P/E 배수
11. P/S 배수
12. EV/EBITDA 배수
13. 순자산 가치
14. 영업권 가치
15. 자산 재평가
16. 부채 조정
17. 세율 가정
18. 상증법 순손익
19. 상증법 순자산
20. 최종 기업가치 (하한)
21. 최종 기업가치 (중간)
22. 최종 기업가치 (상한)

**승인 포인트 데이터 구조**:
```typescript
interface ApprovalPoint {
  id: string;
  project_id: string;
  step_number: number;
  category: string;
  title: string;
  description: string;
  scenarios: Scenario[];
  selected_scenario: 'optimistic' | 'neutral' | 'conservative';
  status: 'pending' | 'approved' | 'rejected';
  accountant_note: string;
}

interface Scenario {
  label: string;
  value: number | string;
  description: string;
  is_recommended: boolean;
}
```

### FR-030: Step 11 - 수정

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 회계사가 초안 수정
- 수정 이력 저장 (`revisions` 테이블)
- 버전 관리 (v1, v2, v3, ...)
- Diff 기능 (변경 내역 표시)

### FR-031: Step 12 - 최종 보고서

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 회계사 승인 후 최종 보고서 생성
- PDF 변환
- 워터마크 추가 (회사 로고, 날짜)
- 전자서명 (향후)
- `reports` 테이블에 저장

### FR-032: Step 13 - 납품

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 고객에게 이메일 발송 (보고서 링크)
- 다운로드 링크 생성 (24시간 유효)
- 다운로드 이력 저장

### FR-033: Step 14 - 피드백

**우선순위**: P1 (중요)
**Stage**: S3

**요구사항**:
- 고객이 평가 서비스에 대한 피드백 작성
- 별점 (1-5)
- 코멘트 (선택)
- 피드백은 관리자만 조회 가능

---

## 5. 평가 엔진

### FR-040: DCF 평가 엔진

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 현금흐름할인법 (Discounted Cash Flow)
- 5년 현금흐름 예측
- WACC (가중평균자본비용) 계산
- 영구 성장률 적용
- 기업가치, 주당가치 산출

**입력**:
- 재무제표 (3년)
- 매출 성장률 가정
- 영업이익률 가정
- CAPEX 가정
- 운전자본 변동 가정
- 할인율 (WACC)
- 영구 성장률

**출력**:
- 5년 현금흐름 예측표
- 할인된 현금흐름 합계
- 영속가치 (Terminal Value)
- 기업가치 (Enterprise Value)
- 주당가치 (Per Share Value)

**계산식**:
```
FCF = EBIT * (1 - 세율) + 감가상각 - CAPEX - 운전자본 변동

기업가치 = Σ(FCFt / (1 + WACC)^t) + TV / (1 + WACC)^5

TV (영속가치) = FCF5 * (1 + g) / (WACC - g)

주당가치 = (기업가치 - 순부채) / 발행주식수
```

### FR-041: 상대가치 평가 엔진

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 유사 기업 비교법 (Comparable Company Analysis)
- P/E, P/S, EV/EBITDA 배수 적용
- 유사 기업 3개 이상 선정

**입력**:
- 유사 기업 목록 (3-5개)
- 각 기업의 재무 데이터
- 배수 선택 (P/E, P/S, EV/EBITDA)

**출력**:
- 유사 기업 비교표
- 평균 배수
- 중간값 배수
- 평가 대상 기업 가치

**계산식**:
```
P/E 배수 = 시가총액 / 당기순이익
P/S 배수 = 시가총액 / 매출
EV/EBITDA 배수 = 기업가치 / EBITDA

평가 대상 기업가치 = 평균 배수 × 평가 대상 기업 지표
```

### FR-042: 자산가치 평가 엔진

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 순자산가치법 (Net Asset Value)
- 자산 재평가
- 부채 조정

**입력**:
- 재무상태표
- 자산 재평가 정보
- 부채 조정 정보

**출력**:
- 자산 재평가표
- 부채 조정표
- 순자산가치

**계산식**:
```
순자산가치 = 재평가 후 자산 - 조정 후 부채
```

### FR-043: 본질가치 평가 엔진

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 수익가치 + 순자산가치 가중평균
- 비상장기업 평가에 적합

**입력**:
- 수익가치 (예: DCF 결과)
- 순자산가치 (예: Asset 평가 결과)
- 가중치 (수익가치:순자산가치 = 3:2 기본)

**출력**:
- 수익가치
- 순자산가치
- 본질가치 (가중평균)

**계산식**:
```
본질가치 = (수익가치 × 0.6) + (순자산가치 × 0.4)
```

### FR-044: 상증법 평가 엔진

**우선순위**: P0 (필수)
**Stage**: S3

**요구사항**:
- 상속세 및 증여세법 기준 평가
- 순손익가치 + 순자산가치 가중평균
- 가업승계, 증여 목적

**입력**:
- 최근 3년 순손익
- 순자산가치
- 가중치 (순손익:순자산 = 3:2)

**출력**:
- 1주당 순손익가치
- 1주당 순자산가치
- 1주당 가액

**계산식**:
```
1주당 순손익가치 = (최근 3년 순이익 평균 ÷ 0.1) ÷ 발행주식수
1주당 순자산가치 = 순자산 ÷ 발행주식수
1주당 가액 = (1주당 순손익가치 × 3 + 1주당 순자산가치 × 2) ÷ 5
```

---

## 6. 대시보드

### FR-050: 고객 대시보드

**우선순위**: P0 (필수)
**Stage**: S2

**요구사항**:
- 내 프로젝트 목록
- 프로젝트 상태 표시
- 최근 활동 로그
- 결제 내역

**위젯**:
1. **프로젝트 현황**: 총 프로젝트 수, 진행 중, 완료
2. **다음 할 일**: 다음 단계 안내
3. **최근 활동**: 견적 수신, 승인 포인트, 보고서 완성
4. **결제 내역**: 결제 일자, 금액, 상태

### FR-051: 회계사 대시보드

**우선순위**: P0 (필수)
**Stage**: S2

**요구사항**:
- 할당된 프로젝트 목록
- 승인 대기 중인 포인트
- 작업 현황 (초안, 수정)
- 이번 달 수익

**위젯**:
1. **작업 현황**: 할당된 프로젝트 수, 승인 대기, 작업 중
2. **승인 포인트 대기열**: 승인 필요한 포인트 목록
3. **최근 작업**: 초안 생성, 수정 완료
4. **이번 달 수익**: 완료한 프로젝트 수 × 수수료

### FR-052: 관리자 대시보드

**우선순위**: P0 (필수)
**Stage**: S2

**요구사항**:
- 전체 프로젝트 통계
- 월별 매출
- 사용자 현황
- 시스템 상태

**위젯**:
1. **프로젝트 통계**: 총 프로젝트, 진행 중, 완료, 취소
2. **월별 매출**: 차트 (최근 12개월)
3. **사용자 현황**: 고객, 회계사, 총 사용자
4. **시스템 상태**: API 응답 시간, 에러율, 트래픽

---

## 7. 관리자 기능

### FR-060: 사용자 관리

**우선순위**: P1 (중요)
**Stage**: S4

**요구사항**:
- 사용자 목록 조회
- 사용자 상세 정보
- 역할 변경
- 사용자 비활성화

### FR-061: 회계사 관리

**우선순위**: P1 (중요)
**Stage**: S4

**요구사항**:
- 회계사 목록 조회
- 프로젝트 할당
- 성과 조회 (완료한 프로젝트 수, 평균 소요 시간)

### FR-062: 결제 관리

**우선순위**: P0 (필수)
**Stage**: S4

**요구사항**:
- 결제 내역 조회
- 환불 처리
- 세금계산서 발행 (향후)

### FR-063: 통계 분석

**우선순위**: P1 (중요)
**Stage**: S4

**요구사항**:
- 월별 매출 차트
- 평가 방법별 분포
- 전환율 분석 (견적 → 계약 → 완료)
- 트래픽 분석

---

## 8. 투자 추적 시스템

### FR-070: 투자 정보 등록

**우선순위**: P2 (낮음)
**Stage**: S4

**요구사항**:
- 투자한 기업 정보 등록
- 투자금액, 지분율 입력
- 투자 단계 (Seed, Series A, B, C, ...)

### FR-071: 포트폴리오 관리

**우선순위**: P2 (낮음)
**Stage**: S4

**요구사항**:
- 투자 포트폴리오 목록
- 투자금액 합계
- 현재 가치 (예상)
- ROI 계산

### FR-072: 투자 분석

**우선순위**: P2 (낮음)
**Stage**: S4

**요구사항**:
- 투자 성과 차트
- 업종별 분포
- 단계별 분포
- 엑시트 시뮬레이션

---

## 9. AI Avatar IR (계획)

### FR-080: AI Avatar 설정

**우선순위**: P3 (낮음)
**Stage**: S4-S5

**요구사항**:
- 기업 정보 학습
- FAQ 등록
- Avatar 이름/성격 설정

### FR-081: 24시간 투자자 대응

**우선순위**: P3 (낮음)
**Stage**: S4-S5

**요구사항**:
- 투자자 질문 자동 응답
- 대화 로그 저장
- 관리자 검토 및 수정

---

## 10. 랭킹 시스템 (계획)

### FR-090: 기업 랭킹 목록

**우선순위**: P3 (낮음)
**Stage**: S4-S5

**요구사항**:
- 객관적 기준 기반 랭킹
- 필터링 (업종, 지역, 투자단계)
- 정렬 (매출, 성장률, 기업가치)

### FR-091: 기업 상세 정보

**우선순위**: P3 (낮음)
**Stage**: S4-S5

**요구사항**:
- 기업 개요
- 재무 정보 (공개 범위)
- 투자 이력
- 관심 기업 등록

---

## 11. 매칭 시스템 (계획)

### FR-100: AI 기반 매칭

**우선순위**: P3 (낮음)
**Stage**: S4-S5

**요구사항**:
- 투자자-기업 자동 매칭
- 매칭 스코어 계산
- 매칭 결과 알림

---

## 12. 비기능 요구사항 (Non-Functional Requirements)

### NFR-001: 성능

**요구사항**:
- 페이지 로드 시간: < 3초
- API 응답 시간: < 500ms
- Lighthouse 스코어: 90+
- 동시 사용자: 100명 이상

### NFR-002: 보안

**요구사항**:
- HTTPS 전용
- JWT 토큰 기반 인증
- RLS (Row Level Security) 적용
- OWASP Top 10 취약점 없음
- 정기 보안 감사

### NFR-003: 확장성

**요구사항**:
- 수평 확장 가능 (Serverless)
- Database Connection Pooling
- CDN 사용 (Vercel Edge)

### NFR-004: 가용성

**요구사항**:
- Uptime: 99.9% 이상
- 자동 백업 (일 1회)
- Disaster Recovery 계획

### NFR-005: 사용성

**요구사항**:
- 반응형 디자인 (Mobile, Tablet, Desktop)
- WCAG AA 준수 (접근성)
- 다국어 지원 (한국어, 영어) - 향후

---

## 요약

```
✅ 총 100개 이상 기능 요구사항 정의
✅ 4개 사용자 역할 및 권한 정의
✅ 14단계 워크플로우 상세 요구사항
✅ 5개 평가 엔진 입출력 명세
✅ 22개 승인 포인트 시스템
✅ 3개 대시보드 (고객, 회계사, 관리자)
✅ 관리자 기능 (사용자, 회계사, 결제, 통계)
✅ 투자 추적, AI Avatar, 랭킹, 매칭 (계획)
✅ 비기능 요구사항 (성능, 보안, 확장성, 가용성, 사용성)
```

**P2 완료**: 8개 문서 모두 작성 완료!

**다음 단계**: P3 프로토타입 정리 → S0 SAL Grid 생성

**작성자**: Claude Code
**참조**: 126개 Python 파일, 72개 HTML 페이지, 데이터베이스 스키마
**버전**: 1.0
**작성일**: 2026-02-05
