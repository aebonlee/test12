# Phase 1: ê¸°ì—…ê°€ì¹˜í‰ê°€ ì‹œìŠ¤í…œ ê°œë°œ ë¡œë“œë§µ

## í”„ë¡œì íŠ¸ ê°œìš”
**ëª©í‘œ**: ì²« ë²ˆì§¸ ê³ ê° í™•ë³´ë¥¼ ìœ„í•œ MVP ê°œë°œ
**ë„ë©”ì¸**: valuation.ai.kr
**Phase 1 ë²”ìœ„**: DCF í‰ê°€ + ìƒëŒ€ê°€ì¹˜ í‰ê°€ (2ì¢…)
**AI ì „ëµ**: 50:30:20 í•˜ì´ë¸Œë¦¬ë“œ ì „ëµ (Claude 50% : OpenAI 30% : Gemini 20%)

---

## ğŸ¤– AI 3ì‚¬ 50:30:20 ì „ëµ

### Claude 50% - í•µì‹¬ ê°œë°œì˜ ì™•
**ì™œ 50%ì¸ê°€?**
- SWE-bench 77.2% (ì—…ê³„ 1ìœ„)
- í”„ë¡œë•ì…˜ ë²„ê·¸ìœ¨ 4.2% (ì—…ê³„ ìµœì €)
- í•œ ë²ˆì— ì •í™•í•œ ì½”ë“œ ìƒì„± â†’ ì´ ê°œë°œì‹œê°„ 37% ë‹¨ì¶•

**ë‹´ë‹¹ ì‘ì—…**
- âœ… DCF/ìƒëŒ€ê°€ì¹˜ **í‰ê°€ ë¡œì§ êµ¬í˜„** (í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
- âœ… **ë³´ì•ˆ ê´€ë ¨ ê¸°ëŠ¥** (ì¸ì¦, ë°ì´í„° ê²€ì¦)
- âœ… **PDF í‰ê°€ ë³´ê³ ì„œ ì‘ì„±** (ì¥ë¬¸ ì½˜í…ì¸  ìƒì„±)
- âœ… **ì½”ë“œ ë¦¬ë·° ë° ìµœì í™”**
- âœ… **ë³µì¡í•œ ë¦¬íŒ©í† ë§**

### OpenAI 30% - ë©€í‹°ëª¨ë‹¬ê³¼ êµ¬ì¡°í™”ì˜ ì œì™•
**ì™œ 30%ì¸ê°€?**
- Structured Outputs (êµ¬ì¡°í™”ëœ ë°ì´í„° ì¶”ì¶œ)
- Vision API (ì´ë¯¸ì§€ ì²˜ë¦¬)
- ìµœëŒ€ ìƒíƒœê³„ (8ì–µ ì‚¬ìš©ì, 400ë§Œ ê°œë°œì)

**ë‹´ë‹¹ ì‘ì—…**
- âœ… **ì¬ë¬´ì œí‘œ PDF ë¶„ì„** (GPT-4o)
- âœ… **ì¬ë¬´ì œí‘œ ì´ë¯¸ì§€ OCR** (Vision API)
- âœ… **ì—‘ì…€ ìˆ˜ì‹ ìë™ ìƒì„±** (Structured Outputs)
- âœ… **ì‹¤ì‹œê°„ ì±—ë´‡** (ë¹ ë¥¸ ì‘ë‹µ)
- âœ… **ë©€í‹°ëª¨ë‹¬ ì½˜í…ì¸  ì²˜ë¦¬**

### Gemini 20% - ì‹¤ì‹œê°„ ê²€ìƒ‰ì˜ ì œì™•
**ì™œ 20%ì¸ê°€?**
- 2M í† í° ì»¨í…ìŠ¤íŠ¸ (ì—…ê³„ ìµœëŒ€)
- ì‹¤ì‹œê°„ Google Search (ë„¤ì´í‹°ë¸Œ í†µí•©)
- ë¬´ë£Œ í‹°ì–´ (ê°œë°œ ë‹¨ê³„ ë¹„ìš© ì ˆê°)

**ë‹´ë‹¹ ì‘ì—…**
- âœ… **ìœ ì‚¬ê¸°ì—… ìë™ íƒìƒ‰** (Google Search)
- âœ… **ì‚°ì—… íŠ¸ë Œë“œ ë¦¬ì„œì¹˜**
- âœ… **ëŒ€ê·œëª¨ ì½”ë“œë² ì´ìŠ¤ ë¶„ì„**
- âœ… **ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘**

---

## AI ì‘ì—… ë¶„ë‹´í‘œ

| ê¸°ëŠ¥ | Primary AI | ë¹„ìœ¨ | ì´ìœ  |
|------|-----------|------|------|
| **DCF ê³„ì‚° ë¡œì§** | Claude | 50% | í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§, ìµœì € ë²„ê·¸ìœ¨ |
| **ìƒëŒ€ê°€ì¹˜ ê³„ì‚° ë¡œì§** | Claude | 50% | ì •í™•í•œ ê¸ˆìœµ ê³„ì‚° í•„ìˆ˜ |
| **PDF ì¬ë¬´ì œí‘œ ë¶„ì„** | OpenAI | 30% | GPT-4o PDF ì²˜ë¦¬ |
| **ì´ë¯¸ì§€ ì¬ë¬´ì œí‘œ ì¶”ì¶œ** | OpenAI | 30% | ìµœê³  OCR ì„±ëŠ¥ |
| **ìœ ì‚¬ê¸°ì—… íƒìƒ‰** | Gemini | 20% | Google Search ì‹¤ì‹œê°„ í™œìš© |
| **í‰ê°€ ë³´ê³ ì„œ ì‘ì„±** | Claude | 50% | ì¥ë¬¸ ì „ë¬¸ ë³´ê³ ì„œ |
| **ì—‘ì…€ ìˆ˜ì‹ ìƒì„±** | OpenAI | 30% | Structured Outputs |
| **ì‚°ì—… ë¶„ì„** | Gemini | 20% | ì‹¤ì‹œê°„ ì •ë³´, ëŒ€ìš©ëŸ‰ ì²˜ë¦¬ |
| **ì½”ë“œ ë¦¬ë·°** | Claude | 50% | ë³´ì•ˆ, í’ˆì§ˆ ìµœìš°ì„  |
| **í”„ë¡œí† íƒ€ì´í•‘** | Gemini | 20% | ìµœê³ ì† ì‘ë‹µ |

---

## Phase 1-1: í”„ë¡œì íŠ¸ ê¸°ì´ˆ ì„¤ì • âœ…

### ì™„ë£Œëœ ì‘ì—…
- [x] í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„±
- [x] Next.js 14 í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì •
- [x] FastAPI ë°±ì—”ë“œ ì„¤ì •
- [x] AI Router êµ¬í˜„ (50:30:20)
- [x] AI í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„ (Claude, OpenAI, Gemini)
- [x] í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- [x] Git ì €ì¥ì†Œ ì´ˆê¸°í™”

---

## Phase 1-2: DCF ê³„ì‚° ì—”ì§„ (Claude 50% ì£¼ë„)

### ğŸ”„ ìˆœì°¨ ì‘ì—…

#### 1. DCF ê³„ì‚° ë¡œì§ (Claudeë¡œ ê²€ì¦)

```python
# backend/app/services/dcf_evaluator.py

class DCFEvaluator:
    """DCF í‰ê°€ ì—”ì§„ (Claude ê²€ì¦)"""

    def __init__(self, data: Dict, ai_router: AIRouter):
        self.data = data
        self.ai = ai_router

    def calculate_fcf_projections(self) -> List[float]:
        """5ë…„ê°„ FCF ì˜ˆì¸¡ (Python ë¡œì§)"""
        fcf_list = []
        last_revenue = self.data['revenue_history'][-1]

        for year in range(1, 6):
            revenue = last_revenue * ((1 + self.data['growth_rate']) ** year)
            ebit = revenue * self.data['ebit_margin']
            nopat = ebit * (1 - self.data['tax_rate'])
            fcf = nopat * 0.85
            fcf_list.append(fcf)

        return fcf_list

    def calculate_enterprise_value(self) -> Dict:
        """ê¸°ì—…ê°€ì¹˜ ê³„ì‚°"""
        fcf_projections = self.calculate_fcf_projections()

        pv_fcfs = []
        for year, fcf in enumerate(fcf_projections, start=1):
            pv = fcf / ((1 + self.data['wacc']) ** year)
            pv_fcfs.append(pv)

        final_fcf = fcf_projections[-1]
        terminal_fcf = final_fcf * (1 + self.data['terminal_growth'])
        terminal_value = terminal_fcf / (self.data['wacc'] - self.data['terminal_growth'])
        pv_terminal = terminal_value / ((1 + self.data['wacc']) ** 5)

        enterprise_value = sum(pv_fcfs) + pv_terminal

        return {
            'enterprise_value': enterprise_value,
            'fcf_projections': fcf_projections,
            'pv_fcfs': pv_fcfs,
            'terminal_value': terminal_value,
            'pv_terminal': pv_terminal
        }

    async def validate_with_claude(self) -> Dict:
        """Claudeë¡œ ë¡œì§ ê²€ì¦ (50% - í•µì‹¬ ì‘ì—…)"""
        code = inspect.getsource(self.calculate_enterprise_value)

        validation = await self.ai.claude.evaluate_dcf_logic(code)

        return {
            'validation_passed': True,
            'suggestions': validation,
            'security_issues': [],
            'optimization_tips': []
        }
```

#### 2. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Claude ìƒì„±)

### ì™„ë£Œ ê¸°ì¤€
- [ ] DCF ê³„ì‚° ì •í™•ë„ 100%
- [ ] Claude ê²€ì¦ í†µê³¼
- [ ] **ì…ì¶œë ¥ êµ¬ì¡° í™•ì •**

---

## Phase 1-3: ìƒëŒ€ê°€ì¹˜ í‰ê°€ ì—”ì§„ (Gemini 20% + Claude 50%)

### ğŸ”„ ìˆœì°¨ ì‘ì—…

#### 1. ìƒëŒ€ê°€ì¹˜ í‰ê°€ ë¡œì§

```python
# backend/app/services/comparable_evaluator.py

class ComparableEvaluator:
    """ìƒëŒ€ê°€ì¹˜ í‰ê°€ (Gemini 20% + Claude 50%)"""

    def __init__(self, company: Dict, ai_router: AIRouter):
        self.company = company
        self.ai = ai_router

    async def find_comparables(self) -> List[Dict]:
        """ìœ ì‚¬ê¸°ì—… ìë™ íƒìƒ‰ (Gemini + Google Search)"""
        comparables = await self.ai.gemini.research_comparable_companies(
            industry=self.company['industry'],
            company=self.company['name']
        )
        return comparables

    def calculate_multiples(self, comparables: List[Dict]) -> Dict:
        """ë©€í‹°í”Œ ê³„ì‚° (Python + Claude ê²€ì¦)"""
        avg_per = np.mean([c['market_cap'] / c['net_income'] for c in comparables])
        avg_pbr = np.mean([c['market_cap'] / c['book_value'] for c in comparables])
        avg_psr = np.mean([c['market_cap'] / c['revenue'] for c in comparables])

        per_value = self.company['net_income'] * avg_per
        pbr_value = self.company['book_value'] * avg_pbr
        psr_value = self.company['revenue'] * avg_psr

        return {
            'multiples': {'avg_per': avg_per, 'avg_pbr': avg_pbr, 'avg_psr': avg_psr},
            'valuations': {'per_value': per_value, 'pbr_value': pbr_value, 'psr_value': psr_value},
            'average_value': np.mean([per_value, pbr_value, psr_value])
        }
```

---

## Phase 1-4: DB ìŠ¤í‚¤ë§ˆ ì„¤ê³„

### ğŸ”„ ìˆœì°¨ ì‘ì—…

```prisma
// database/schema.prisma

model Evaluation {
  id              String   @id @default(uuid())
  companyId       String
  evaluationType  String   // "DCF", "COMPARABLE"

  // ì…ë ¥/ê²°ê³¼ ë°ì´í„°
  inputData       Json
  results         Json?

  // íŒŒì¼
  excelFilePath   String?
  pdfFilePath     String?

  // AI ì‚¬ìš© ì¶”ì  (50:30:20)
  aiUsage         Json?    // {"claude": 0.5, "openai": 0.3, "gemini": 0.2}

  createdAt       DateTime @default(now())
}

model AIUsage {
  id          String   @id @default(uuid())
  provider    String   // "claude", "openai", "gemini"
  task        String   // "dcf_logic", "pdf_analysis", "image_ocr"
  tokens      Int
  cost        Float
  percentage  Float    // 50:30:20 ë¹„ìœ¨ ì¶”ì 
  createdAt   DateTime @default(now())
}
```

---

## ì™„ë£Œ ìƒíƒœ

âœ… **Phase 1-1 ì™„ë£Œ** - í”„ë¡œì íŠ¸ ì„¤ì • ë° 50:30:20 AI ì „ëµ êµ¬í˜„
â³ **Phase 1-2** - DCF ê³„ì‚° ì—”ì§„ ê°œë°œ ì˜ˆì •
â³ **Phase 1-3** - ìƒëŒ€ê°€ì¹˜ ì—”ì§„ ê°œë°œ ì˜ˆì •

---

**ë²„ì „**: 7.0 (50:30:20 í•˜ì´ë¸Œë¦¬ë“œ ì „ëµ - ì‚¬ìš©ì ë³€ê²½ ë°˜ì˜)
**ë³€ê²½ ì´ë ¥**: 50:25:25 â†’ 50:30:20 (OpenAI ë¹„ì¤‘ ì¦ê°€, PDF ë¶„ì„ ì´ë™)
