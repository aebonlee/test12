# DCF 평가 자동화 워크플로우 (최종안)

**작성일**: 2025-10-17
**핵심 원칙**: 평가자는 **승인만**, 나머지는 **AI/회사가 처리**

---

## 핵심 철학

```
❌ 잘못된 모델: 평가자가 모든 것을 입력/판단
✅ 올바른 모델: AI가 초안 작성 → 평가자가 승인

역할 분담:
├─ 🏢 회사: 문서 업로드
├─ 🤖 AI: 데이터 추출 + 계산 + 초안 작성 + 옵션 제시
└─ ✍️ 평가자: 검토 + 승인 (3번만!)
```

---

## 전체 워크플로우

```
┌─────────────────────────────────────────────────┐
│ DCF 평가 자동화 워크플로우                       │
└─────────────────────────────────────────────────┘

Step 1: 회사 문서 업로드 (회사)
  📤 사업자등록증 업로드
  📤 법인등기부등본 업로드
  📤 외부감사보고서 (3개년) 업로드
  📤 차입금 명세서 업로드
  📤 사업계획서 (5개년) 업로드
  📤 자산 명세서 업로드 (선택)
     ↓
     ↓ 자동 전송
     ↓

Step 2: AI 자동 데이터 추출 (AI)
  🤖 OCR로 기본 정보 추출
  🤖 재무제표 테이블 인식 및 추출
  🤖 사업계획서 숫자 추출
  🤖 차입금 이자율 추출
  🤖 재무비율 자동 계산
     ↓
     ↓ 검증 요청
     ↓

Step 3: 회사 데이터 검증 (회사)
  ✅ 추출된 데이터 확인
  ✏️  오류 있으면 수정
  ✔️  확정 버튼 클릭
     ↓
     ↓ 외부 데이터 수집 시작
     ↓

Step 4: AI 외부 데이터 수집 (AI)
  🤖 무위험이자율 수집 (한국은행 API)
  🤖 업종별 베타 수집 (DB/웹)
  🤖 시장위험프리미엄 수집
  🤖 업종 평균 데이터 수집
     ↓
     ↓ WACC 계산
     ↓

Step 5: AI가 WACC 시나리오 계산 및 제시 (AI)
  🤖 시나리오 A: 현재 자본구조 기준 WACC
  🤖 시나리오 B: 업종 평균 자본구조 WACC
  🤖 시나리오 C: 목표 자본구조 WACC
  🤖 각 시나리오별 기업가치 미리보기
     ↓
     ↓ 평가자에게 선택 요청
     ↓

Step 6: 평가자 WACC 승인 (평가자) ← 승인 1/3
  ┌─────────────────────────────────────────┐
  │ WACC 시나리오 선택                       │
  │ ◉ 시나리오 A: 10.83% (현재 구조)        │
  │   → 기업가치: 735억원                   │
  │                                         │
  │ ○ 시나리오 B: 9.65% (업종 평균)         │
  │   → 기업가치: 972억원                   │
  │                                         │
  │ ○ 시나리오 C: 11.50% (보수적)           │
  │   → 기업가치: 650억원                   │
  │                                         │
  │ [승인]                                  │
  └─────────────────────────────────────────┘
     ↓
     ↓ WACC 확정
     ↓

Step 7: AI가 DCF 계산 실행 (AI)
  🤖 5개년 FCF 예측
  🤖 영구가치 계산
  🤖 현재가치 할인
  🤖 기업가치 산출
  🤖 주주가치 산출
  🤖 주당가치 계산
  🤖 민감도 분석 (WACC ±1%, g ±0.5%)
     ↓
     ↓ 결과 요약 제시
     ↓

Step 8: 평가자 결과 검토 및 승인 (평가자) ← 승인 2/3
  ┌─────────────────────────────────────────┐
  │ DCF 계산 결과 요약                       │
  │                                         │
  │ 기업가치: 735억원                        │
  │ 주주가치: 742억원                        │
  │ 주당가치: 74,245원                       │
  │                                         │
  │ 주요 가정:                               │
  │ - WACC: 10.83%                          │
  │ - 영구성장률: 2.5%                       │
  │ - 5년 평균 성장률: 30.4%                │
  │                                         │
  │ [상세 보기] [승인] [재계산]              │
  └─────────────────────────────────────────┘
     ↓
     ↓ 승인 시
     ↓

Step 9: AI가 평가보고서 초안 생성 (AI)
  🤖 표지 및 목차 생성
  🤖 회사 개요 작성
  🤖 재무 분석 챕터 작성
  🤖 평가 방법론 설명
  🤖 가정 및 근거 정리
  🤖 DCF 계산 과정 상세 설명
  🤖 민감도 분석 표/그래프
  🤖 결론 및 의견 작성
  🤖 PDF 생성
     ↓
     ↓ 평가자에게 전달
     ↓

Step 10: 평가자 보고서 최종 승인 (평가자) ← 승인 3/3
  ┌─────────────────────────────────────────┐
  │ 평가보고서 미리보기                      │
  │                                         │
  │ [PDF 뷰어]                              │
  │   - 총 35페이지                         │
  │   - 표 12개, 그래프 8개                 │
  │                                         │
  │ [다운로드] [수정 요청] [최종 승인]       │
  └─────────────────────────────────────────┘
     ↓
     ↓ 최종 승인
     ↓

Step 11: 완료 및 배포
  📄 평가보고서 PDF 생성 완료
  📧 이메일 발송 (회사/이해관계자)
  💾 시스템에 영구 저장
  ✅ 프로젝트 완료
```

---

## 평가자 역할 상세 (승인 3번만!)

### 승인 1: WACC 선택 및 승인

**AI가 제시하는 정보**:
```
┌─────────────────────────────────────────────────┐
│ WACC 시나리오 분석                               │
├─────────────────────────────────────────────────┤
│                                                 │
│ 📊 시나리오 A: 현재 자본구조 (권장)             │
│    ├─ 부채비율: D/(D+E) = 15%                   │
│    ├─ 자기자본비용: 12.05%                      │
│    ├─ 타인자본비용: 3.90% (세후)                │
│    ├─ WACC: 10.83%                              │
│    └─ 기업가치: 735억원                         │
│                                                 │
│ 📊 시나리오 B: 업종 평균 자본구조               │
│    ├─ 부채비율: D/(D+E) = 25% (SW 업종 평균)    │
│    ├─ 자기자본비용: 12.05%                      │
│    ├─ 타인자본비용: 3.90% (세후)                │
│    ├─ WACC: 9.65%                               │
│    └─ 기업가치: 972억원                         │
│                                                 │
│ 📊 시나리오 C: 보수적 접근 (안전 마진)          │
│    ├─ 부채비율: D/(D+E) = 10%                   │
│    ├─ 자기자본비용: 12.05%                      │
│    ├─ 타인자본비용: 3.90% (세후)                │
│    ├─ WACC: 11.50%                              │
│    └─ 기업가치: 650억원                         │
│                                                 │
│ 💡 AI 권장: 시나리오 A (현재 자본구조)          │
│    이유: 실제 재무상태 반영, 검증 가능          │
│                                                 │
├─────────────────────────────────────────────────┤
│ 선택:  ◉ 시나리오 A  ○ 시나리오 B  ○ 시나리오 C│
│                                                 │
│ 또는 수동 조정:                                  │
│ WACC: [____]% (직접 입력)                       │
│                                                 │
│ [승인 및 계산 실행]                              │
└─────────────────────────────────────────────────┘
```

**평가자 행동**:
- 3개 시나리오 중 1개 선택 (라디오 버튼 클릭)
- 또는 직접 WACC 입력 (특수한 경우만)
- **[승인 및 계산 실행]** 버튼 클릭

**소요 시간**: 1분

---

### 승인 2: DCF 계산 결과 검토 및 승인

**AI가 제시하는 정보**:
```
┌─────────────────────────────────────────────────┐
│ DCF 평가 결과                                    │
├─────────────────────────────────────────────────┤
│                                                 │
│ 📈 평가 결과 요약                                │
│    기업가치 (EV):    735억원                     │
│    주주가치:         742억원                     │
│    주당가치:         74,245원                    │
│                                                 │
│ 📊 주요 가정                                     │
│    WACC:             10.83%                      │
│    영구성장률 (g):   2.5%                        │
│    예측 기간:        5년 (2024-2028)             │
│    평균 성장률:      30.4%                       │
│                                                 │
│ 💰 FCF 흐름                                      │
│    2024E: 2,856백만원 → PV: 2,577백만원         │
│    2025E: 3,881백만원 → PV: 3,160백만원         │
│    2026E: 5,065백만원 → PV: 3,721백만원         │
│    2027E: 6,259백만원 → PV: 4,148백만원         │
│    2028E: 7,530백만원 → PV: 4,503백만원         │
│    합계 PV(FCF): 18,109백만원                    │
│                                                 │
│ 🔮 영구가치                                      │
│    Terminal Value: 92,660백만원                 │
│    PV(TV):         55,412백만원                 │
│    TV 비중:        75.4%  ✓ 정상 (50-80%)       │
│                                                 │
│ 📉 민감도 분석                                   │
│    WACC +1%p → 기업가치: 650억 (-11.6%)         │
│    WACC -1%p → 기업가치: 850억 (+15.6%)         │
│    g +0.5%p  → 기업가치: 790억 (+7.5%)          │
│    g -0.5%p  → 기업가치: 690억 (-6.1%)          │
│                                                 │
│ ⚠️  검토 사항                                    │
│    ✅ TV 비중 정상 범위                          │
│    ✅ WACC > g (계산 가능)                       │
│    ✅ 성장률 합리적 범위                         │
│    ✅ 영업이익률 개선 추세                       │
│                                                 │
├─────────────────────────────────────────────────┤
│ [상세 계산 보기] [재계산 요청] [승인 및 보고서 생성]│
└─────────────────────────────────────────────────┘
```

**평가자 행동**:
- 결과 숫자 확인
- 민감도 분석 확인
- 검토 사항 체크마크 확인
- 이상 없으면 **[승인 및 보고서 생성]** 클릭
- 문제 있으면 **[재계산 요청]** (특정 가정 변경)

**소요 시간**: 3분

---

### 승인 3: 평가보고서 최종 승인

**AI가 제시하는 정보**:
```
┌─────────────────────────────────────────────────┐
│ 평가보고서 생성 완료                             │
├─────────────────────────────────────────────────┤
│                                                 │
│ 📄 보고서 정보                                   │
│    제목: 주식회사 테크밸리 기업가치평가 보고서   │
│    평가기준일: 2024년 12월 31일                  │
│    총 페이지: 35페이지                           │
│    생성일시: 2025-01-15 14:30                    │
│                                                 │
│ 📑 목차                                          │
│    I.   평가 개요 ...................... 3p     │
│    II.  회사 개요 ...................... 7p     │
│    III. 재무 분석 ..................... 12p     │
│    IV.  평가 방법론 ................... 18p     │
│    V.   DCF 평가 ...................... 22p     │
│    VI.  민감도 분석 ................... 28p     │
│    VII. 결론 및 의견 .................. 32p     │
│    VIII. 부록 ......................... 34p     │
│                                                 │
│ 📊 포함 내용                                     │
│    ✓ 재무제표 3개년                              │
│    ✓ FCF 계산 상세                               │
│    ✓ WACC 계산 근거                              │
│    ✓ 민감도 분석 표/그래프                       │
│    ✓ 가정 및 한계점                              │
│                                                 │
│ [PDF 미리보기 열기]                              │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│ ┌───────────────────────────────────────────┐ │
│ │ [PDF 뷰어 - 35페이지]                     │ │
│ │                                           │ │
│ │ ▼ 스크롤하여 전체 보고서 검토              │ │
│ │                                           │ │
│ │ [페이지 1/35]  [이전] [다음] [확대/축소]  │ │
│ └───────────────────────────────────────────┘ │
│                                                 │
├─────────────────────────────────────────────────┤
│ 수정 필요 시:                                    │
│ ☐ 표지 회사명 수정                               │
│ ☐ 특정 문구 변경                                 │
│ ☐ 그래프 스타일 변경                             │
│                                                 │
│ [수정 요청 (AI 재생성)] [최종 승인 및 배포]      │
└─────────────────────────────────────────────────┘
```

**평가자 행동**:
- PDF 스크롤하며 전체 확인
- 숫자 정확성 확인
- 오타 체크
- 이상 없으면 **[최종 승인 및 배포]** 클릭
- 수정 필요 시 체크박스 선택 후 **[수정 요청]**

**소요 시간**: 5분

---

## AI 자동화 상세

### 1. WACC 시나리오 자동 생성

**AI 계산 로직**:
```python
def generate_wacc_scenarios(company_data, industry_data):
    """WACC 3가지 시나리오 자동 생성"""

    # 공통 파라미터
    rf = get_risk_free_rate()  # 한국은행 API
    beta = industry_data['beta']  # 업종 베타
    mrp = 0.07  # 시장위험프리미엄
    rd = company_data['weighted_interest_rate']  # 차입금 명세서
    tax_rate = 0.22

    re = rf + beta * mrp  # CAPM

    # 시나리오 A: 현재 자본구조
    current_debt_ratio = company_data['current_debt_ratio']
    wacc_a = calculate_wacc(re, rd, current_debt_ratio, tax_rate)
    ev_a = run_dcf(company_data, wacc_a)

    # 시나리오 B: 업종 평균 자본구조
    industry_debt_ratio = industry_data['average_debt_ratio']
    wacc_b = calculate_wacc(re, rd, industry_debt_ratio, tax_rate)
    ev_b = run_dcf(company_data, wacc_b)

    # 시나리오 C: 보수적 (부채비율 -5%p)
    conservative_debt_ratio = max(0, current_debt_ratio - 0.05)
    wacc_c = calculate_wacc(re, rd, conservative_debt_ratio, tax_rate)
    ev_c = run_dcf(company_data, wacc_c)

    return {
        'scenario_a': {
            'name': '현재 자본구조',
            'wacc': wacc_a,
            'enterprise_value': ev_a,
            'recommended': True,  # AI 권장
            'rationale': '실제 재무상태 반영, 검증 가능'
        },
        'scenario_b': {
            'name': '업종 평균 자본구조',
            'wacc': wacc_b,
            'enterprise_value': ev_b,
            'recommended': False,
            'rationale': '업종 표준 반영, 비교 가능'
        },
        'scenario_c': {
            'name': '보수적 접근',
            'wacc': wacc_c,
            'enterprise_value': ev_c,
            'recommended': False,
            'rationale': '안전 마진 확보'
        }
    }
```

### 2. 평가보고서 자동 생성

**AI 보고서 작성 로직**:
```python
def generate_valuation_report(company_data, dcf_result, wacc_scenario):
    """평가보고서 자동 생성"""

    report = ValuationReport()

    # 1. 표지 생성
    report.add_cover_page(
        title=f"{company_data['company_name']} 기업가치평가 보고서",
        valuation_date=company_data['valuation_date'],
        evaluator="AI 자동 평가 시스템"
    )

    # 2. 목차 생성
    report.add_table_of_contents()

    # 3. 평가 개요 (AI 자동 작성)
    overview_text = f"""
    본 보고서는 {company_data['company_name']}의 기업가치를
    현금흐름할인법(DCF)을 사용하여 평가한 결과입니다.

    평가 결과, {company_data['valuation_date']} 기준
    기업가치는 {dcf_result['enterprise_value']:,.0f}백만원,
    주주가치는 {dcf_result['equity_value']:,.0f}백만원,
    주당가치는 {dcf_result['value_per_share']:,.0f}원으로
    산출되었습니다.
    """
    report.add_section("평가 개요", overview_text)

    # 4. 회사 개요 (업로드 문서에서 추출)
    company_overview = extract_company_info(company_data)
    report.add_section("회사 개요", company_overview)

    # 5. 재무 분석 (재무제표 기반 자동 분석)
    financial_analysis = analyze_financials(company_data['financials'])
    report.add_section("재무 분석", financial_analysis)
    report.add_table("과거 재무제표", create_financial_table())
    report.add_chart("매출 및 수익성 추이", create_revenue_chart())

    # 6. 평가 방법론 설명
    methodology_text = """
    본 평가에서는 현금흐름할인법(DCF)을 사용하였습니다.
    DCF는 기업이 미래에 창출할 잉여현금흐름을 추정하고,
    이를 적절한 할인율(WACC)로 현재가치로 환산하여
    기업가치를 산출하는 방법입니다.
    ...
    """
    report.add_section("평가 방법론", methodology_text)

    # 7. DCF 평가 상세
    dcf_detail = f"""
    7.1 WACC 계산

    선택된 시나리오: {wacc_scenario['name']}
    - 무위험이자율: {wacc_scenario['rf']:.2%}
    - 베타: {wacc_scenario['beta']:.2f}
    - 시장위험프리미엄: {wacc_scenario['mrp']:.2%}
    - 자기자본비용: {wacc_scenario['re']:.2%}
    - 타인자본비용(세후): {wacc_scenario['rd_at']:.2%}
    - 가중평균자본비용(WACC): {wacc_scenario['wacc']:.2%}

    7.2 FCF 예측
    ...
    """
    report.add_section("DCF 평가", dcf_detail)
    report.add_table("FCF 예측", create_fcf_table())
    report.add_chart("FCF 추이", create_fcf_chart())

    # 8. 민감도 분석
    sensitivity = perform_sensitivity_analysis(dcf_result)
    report.add_section("민감도 분석", sensitivity['text'])
    report.add_table("민감도 분석표", sensitivity['table'])
    report.add_heatmap("민감도 히트맵", sensitivity['heatmap'])

    # 9. 결론 및 의견 (AI 자동 작성)
    conclusion = f"""
    상기 분석 결과, {company_data['company_name']}의
    기업가치는 {dcf_result['enterprise_value']:,.0f}백만원으로
    평가됩니다.

    주요 가정:
    - WACC: {wacc_scenario['wacc']:.2%}
    - 영구성장률: {dcf_result['terminal_growth']:.2%}
    - 예측 기간: {dcf_result['forecast_years']}년

    본 평가는 현재 시점의 정보를 기반으로 하며,
    향후 경영환경 변화에 따라 달라질 수 있습니다.
    """
    report.add_section("결론 및 의견", conclusion)

    # 10. 부록 (상세 계산 과정)
    report.add_appendix("재무제표 원본", company_data['financials'])
    report.add_appendix("WACC 계산 상세", wacc_scenario['detail'])
    report.add_appendix("FCF 계산 상세", dcf_result['fcf_detail'])

    # PDF 생성
    pdf_file = report.generate_pdf()

    return pdf_file
```

---

## 시스템 아키텍처

### 전체 시스템 구성

```
┌─────────────────────────────────────────────────┐
│ 프론트엔드 (React/Next.js)                       │
│ - 문서 업로드 UI                                 │
│ - 데이터 검증 UI                                 │
│ - 시나리오 선택 UI                               │
│ - 보고서 뷰어                                    │
└─────────────────────────────────────────────────┘
                      ↕ API
┌─────────────────────────────────────────────────┐
│ 백엔드 API (FastAPI/Django)                      │
│ - 파일 업로드 처리                               │
│ - AI 엔진 오케스트레이션                         │
│ - 사용자 인증/권한                               │
│ - 프로젝트 상태 관리                             │
└─────────────────────────────────────────────────┘
          ↕                    ↕                ↕
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│ AI 추출 엔진     │  │ DCF 계산 엔진    │  │ 보고서 생성 엔진 │
│ - OCR (Tesseract)│  │ - WACC 계산     │  │ - PDF 생성      │
│ - PDF 파싱       │  │ - FCF 예측      │  │ - 차트 생성     │
│ - 테이블 인식    │  │ - 민감도 분석   │  │ - AI 텍스트     │
│ - 숫자 추출      │  │ - 시나리오 분석 │  │   생성 (GPT)    │
└─────────────────┘  └─────────────────┘  └─────────────────┘
          ↕                    ↕
┌─────────────────┐  ┌─────────────────┐
│ 외부 API        │  │ 데이터베이스     │
│ - 한국은행       │  │ - PostgreSQL    │
│ - DART          │  │ - 프로젝트 정보  │
│ - 업종 데이터 DB │  │ - 재무 데이터   │
└─────────────────┘  │ - 계산 결과     │
                     │ - 보고서 이력    │
                     └─────────────────┘
```

---

## 평가자 대시보드 예시

```
┌─────────────────────────────────────────────────┐
│ DCF 평가 플랫폼 - 프로젝트 대시보드              │
├─────────────────────────────────────────────────┤
│                                                 │
│ 현재 진행 중인 평가: 주식회사 테크밸리           │
│ 상태: ⏸️  평가자 승인 대기                      │
│                                                 │
│ ┌───────────────────────────────────────────┐ │
│ │ 진행 단계                                 │ │
│ │ ✅ 문서 업로드 완료 (회사)                │ │
│ │ ✅ 데이터 추출 완료 (AI)                  │ │
│ │ ✅ 데이터 검증 완료 (회사)                │ │
│ │ ✅ WACC 계산 완료 (AI)                    │ │
│ │ ⏸️  WACC 승인 대기 (평가자) ← 현재        │ │
│ │ ⏳ DCF 계산 대기                          │ │
│ │ ⏳ 보고서 생성 대기                       │ │
│ │ ⏳ 최종 승인 대기                         │ │
│ └───────────────────────────────────────────┘ │
│                                                 │
│ [WACC 시나리오 선택 페이지로 이동 →]            │
│                                                 │
├─────────────────────────────────────────────────┤
│ 최근 완료된 평가                                 │
│ • 주식회사 A - 2025-01-10 완료                  │
│ • 주식회사 B - 2025-01-05 완료                  │
└─────────────────────────────────────────────────┘
```

---

## 소요 시간 분석

### 전체 프로세스 소요 시간

| 단계 | 담당 | 소요 시간 | 비고 |
|------|------|-----------|------|
| 1. 문서 업로드 | 회사 | 10분 | 스캔/업로드 |
| 2. AI 데이터 추출 | AI | 3분 | 자동 |
| 3. 데이터 검증 | 회사 | 5분 | 확인 및 수정 |
| 4. 외부 데이터 수집 | AI | 1분 | 자동 (API) |
| 5. WACC 계산 및 제시 | AI | 1분 | 자동 |
| **6. WACC 승인** | **평가자** | **1분** | **클릭 1번** |
| 7. DCF 계산 | AI | 2분 | 자동 |
| **8. 결과 승인** | **평가자** | **3분** | **검토 + 클릭** |
| 9. 보고서 생성 | AI | 5분 | 자동 |
| **10. 보고서 승인** | **평가자** | **5분** | **검토 + 클릭** |
| **합계** | - | **36분** | **평가자: 9분** |

**평가자 실 작업 시간: 9분 (전체의 25%)**

---

## 핵심 요약

### 역할 분담

**🏢 회사**: 문서 업로드만 (10분)
- 사업자등록증
- 법인등기부등본
- 외부감사보고서
- 차입금 명세서
- **사업계획서** ← 가장 중요
- 자산 명세서 (선택)

**🤖 AI**: 모든 자동 처리 (12분)
- 데이터 추출
- 외부 데이터 수집
- WACC 시나리오 생성
- DCF 계산
- 보고서 자동 작성

**✍️ 평가자**: 승인 3번만 (9분)
1. WACC 시나리오 선택 및 승인 (1분)
2. DCF 결과 검토 및 승인 (3분)
3. 보고서 최종 승인 (5분)

**전체 소요 시간: 36분**
**평가자 실 작업: 9분 (클릭 3번 + 검토)**

---

**완성!** 이제 이 워크플로우대로 시스템을 구축하면 됩니다.
